(function(n){"use strict";function i(t,i){this.itemsArray=[];this.$element=n(t);this.$element.hide();this.isSelect=t.tagName==="SELECT";this.multiple=this.isSelect&&t.hasAttribute("multiple");this.objectItems=i&&i.itemValue;this.placeholderText=t.hasAttribute("placeholder")?this.$element.attr("placeholder"):"";this.inputSize=Math.max(1,this.placeholderText.length);this.$container=n('<div class="bootstrap-tagsinput"><\/div>');this.$input=n('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container);this.$element.after(this.$container);var r=(this.inputSize<3?3:this.inputSize)+"em";this.$input.get(0).style.cssText="width: "+r+" !important;";this.build(i)}function u(n,t){if(typeof n[t]!="function"){var i=n[t];n[t]=function(n){return n[i]}}}function f(n,t){if(typeof n[t]!="function"){var i=n[t];n[t]=function(){return i}}}function t(n){return n?e.text(n).html():""}function o(n){var t=0,i;return document.selection?(n.focus(),i=document.selection.createRange(),i.moveStart("character",-n.value.length),t=i.text.length):(n.selectionStart||n.selectionStart=="0")&&(t=n.selectionStart),t}function s(t,i){var r=!1;return n.each(i,function(n,i){if(typeof i=="number"&&t.which===i)return r=!0,!1;if(t.which===i.which){var u=!i.hasOwnProperty("altKey")||t.altKey===i.altKey,f=!i.hasOwnProperty("shiftKey")||t.shiftKey===i.shiftKey,e=!i.hasOwnProperty("ctrlKey")||t.ctrlKey===i.ctrlKey;if(u&&f&&e)return r=!0,!1}}),r}var r={tagClass:function(){return"label label-info"},itemValue:function(n){return n?n.toString():n},itemText:function(n){return this.itemValue(n)},freeInput:!0,addOnBlur:!0,maxTags:undefined,maxChars:undefined,confirmKeys:[13,44],onTagExists:function(n,t){t.hide().fadeIn()},trimValue:!1,allowDuplicates:!1},e;i.prototype={constructor:i,add:function(i,r){var u=this,f,e,v,c,o,s;if((!u.options.maxTags||!(u.itemsArray.length>=u.options.maxTags))&&(i===!1||i)){if(typeof i=="string"&&u.options.trimValue&&(i=n.trim(i)),typeof i=="object"&&!u.objectItems)throw"Can't add objects when itemValue option is not set";if(!i.toString().match(/^\s*$/)){if(u.isSelect&&!u.multiple&&u.itemsArray.length>0&&u.remove(u.itemsArray[0]),typeof i=="string"&&this.$element[0].tagName==="INPUT"&&(f=i.split(","),f.length>1)){for(e=0;e<f.length;e++)this.add(f[e],!0);r||u.pushVal();return}var h=u.options.itemValue(i),l=u.options.itemText(i),y=u.options.tagClass(i),a=n.grep(u.itemsArray,function(n){return u.options.itemValue(n)===h})[0];if(a&&!u.options.allowDuplicates){if(u.options.onTagExists){v=n(".tag",u.$container).filter(function(){return n(this).data("item")===a});u.options.onTagExists(i,v)}return}u.items().toString().length+i.length+1>u.options.maxInputLength||(c=n.Event("beforeItemAdd",{item:i,cancel:!1}),u.$element.trigger(c),c.cancel)||(u.itemsArray.push(i),o=n('<span class="tag '+t(y)+'">'+t(l)+'<span data-role="remove"><\/span><\/span>'),o.data("item",i),u.findInputWrapper().before(o),o.after(" "),u.isSelect&&!n('option[value="'+encodeURIComponent(h)+'"]',u.$element)[0]&&(s=n("<option selected>"+t(l)+"<\/option>"),s.data("item",i),s.attr("value",h),u.$element.append(s)),r||u.pushVal(),(u.options.maxTags===u.itemsArray.length||u.items().toString().length===u.options.maxInputLength)&&u.$container.addClass("bootstrap-tagsinput-max"),u.$element.trigger(n.Event("itemAdded",{item:i})))}}},remove:function(t,i){var r=this,u;if(r.objectItems&&(t=typeof t=="object"?n.grep(r.itemsArray,function(n){return r.options.itemValue(n)==r.options.itemValue(t)}):n.grep(r.itemsArray,function(n){return r.options.itemValue(n)==t}),t=t[t.length-1]),t){if(u=n.Event("beforeItemRemove",{item:t,cancel:!1}),r.$element.trigger(u),u.cancel)return;n(".tag",r.$container).filter(function(){return n(this).data("item")===t}).remove();n("option",r.$element).filter(function(){return n(this).data("item")===t}).remove();n.inArray(t,r.itemsArray)!==-1&&r.itemsArray.splice(n.inArray(t,r.itemsArray),1)}i||r.pushVal();r.options.maxTags>r.itemsArray.length&&r.$container.removeClass("bootstrap-tagsinput-max");r.$element.trigger(n.Event("itemRemoved",{item:t}))},removeAll:function(){var t=this;for(n(".tag",t.$container).remove(),n("option",t.$element).remove();t.itemsArray.length>0;)t.itemsArray.pop();t.pushVal()},refresh:function(){var i=this;n(".tag",i.$container).each(function(){var r=n(this),u=r.data("item"),e=i.options.itemValue(u),o=i.options.itemText(u),s=i.options.tagClass(u),f;r.attr("class",null);r.addClass("tag "+t(s));r.contents().filter(function(){return this.nodeType==3})[0].nodeValue=t(o);i.isSelect&&(f=n("option",i.$element).filter(function(){return n(this).data("item")===u}),f.attr("value",e))})},items:function(){return this.itemsArray},pushVal:function(){var t=this,i=n.map(t.items(),function(n){return t.options.itemValue(n).toString()});t.$element.val(i,!0).trigger("change")},build:function(t){var i=this,e,h;if(i.options=n.extend({},r,t),i.objectItems&&(i.options.freeInput=!1),u(i.options,"itemValue"),u(i.options,"itemText"),f(i.options,"tagClass"),i.options.typeahead&&(e=i.options.typeahead||{},f(e,"source"),i.$input.typeahead(n.extend({},e,{source:function(t,r){function f(n){for(var u,f=[],t=0;t<n.length;t++)u=i.options.itemText(n[t]),o[u]=n[t],f.push(u);r(f)}this.map={};var o=this.map,u=e.source(t);n.isFunction(u.success)?u.success(f):n.isFunction(u.then)?u.then(f):n.when(u).then(f)},updater:function(n){i.add(this.map[n])},matcher:function(n){return n.toLowerCase().indexOf(this.query.trim().toLowerCase())!==-1},sorter:function(n){return n.sort()},highlighter:function(n){var t=new RegExp("("+this.query+")","gi");return n.replace(t,"<strong>$1<\/strong>")}}))),i.options.typeaheadjs){h=i.options.typeaheadjs||{};i.$input.typeahead(null,h).on("typeahead:selected",n.proxy(function(n,t){h.valueKey?i.add(t[h.valueKey]):i.add(t);i.$input.typeahead("val","")},i))}i.$container.on("click",n.proxy(function(){i.$element.attr("disabled")||i.$input.removeAttr("disabled");i.$input.focus()},i));if(i.options.addOnBlur&&i.options.freeInput)i.$input.on("focusout",n.proxy(function(){n(".typeahead, .twitter-typeahead",i.$container).length===0&&(i.add(i.$input.val()),i.$input.val(""))},i));i.$container.on("keydown","input",n.proxy(function(t){var r=n(t.target),u=i.findInputWrapper(),f,e,s,h;if(i.$element.attr("disabled")){i.$input.attr("disabled","disabled");return}switch(t.which){case 8:o(r[0])===0&&(f=u.prev(),f&&i.remove(f.data("item")));break;case 46:o(r[0])===0&&(e=u.next(),e&&i.remove(e.data("item")));break;case 37:s=u.prev();r.val().length===0&&s[0]&&(s.before(u),r.focus());break;case 39:h=u.next();r.val().length===0&&h[0]&&(h.after(u),r.focus())}var c=r.val().length,l=Math.ceil(c/5),a=c+l+1;r.attr("size",Math.max(this.inputSize,r.val().length))},i));i.$container.on("keypress","input",n.proxy(function(t){var r=n(t.target),u,f;if(i.$element.attr("disabled")){i.$input.attr("disabled","disabled");return}u=r.val();f=i.options.maxChars&&u.length>=i.options.maxChars;i.options.freeInput&&(s(t,i.options.confirmKeys)||f)&&(i.add(f?u.substr(0,i.options.maxChars):u),r.val(""),t.preventDefault());var e=r.val().length,o=Math.ceil(e/5),h=e+o+1;r.attr("size",Math.max(this.inputSize,r.val().length))},i));i.$container.on("click","[data-role=remove]",n.proxy(function(t){i.$element.attr("disabled")||i.remove(n(t.target).closest(".tag").data("item"))},i));i.options.itemValue===r.itemValue&&(i.$element[0].tagName==="INPUT"?i.add(i.$element.val()):n("option",i.$element).each(function(){i.add(n(this).attr("value"),!0)}))},destroy:function(){var n=this;n.$container.off("keypress","input");n.$container.off("click","[role=remove]");n.$container.remove();n.$element.removeData("tagsinput");n.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var t=this.$input[0],i=this.$container[0];t&&t.parentNode!==i;)t=t.parentNode;return n(t)}};n.fn.tagsinput=function(t,r){var u=[];return this.each(function(){var f=n(this).data("tagsinput"),e;f?t||r?f[t]!==undefined&&(e=f[t](r),e!==undefined&&u.push(e)):u.push(f):(f=new i(this,t),n(this).data("tagsinput",f),u.push(f),this.tagName==="SELECT"&&n("option",n(this)).attr("selected","selected"),n(this).val(n(this).val()))}),typeof t=="string"?u.length>1?u:u[0]:u};n.fn.tagsinput.Constructor=i;e=n("<div />");n(function(){n("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})})(window.jQuery);
/*
//# sourceMappingURL=bootstrap-tagsinput.min.js.map
*/